<!DOCTYPE HTML>
<html>
	<head>
		<title>Covid-19 analysis</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<style>
			/* body{
				display:flex;
				justify-content: center;
				align-items: center;
				gap:10px;
				flex-direction: column;
				height: 100vh;
			} */
			/* #display_image{
				width: 375px;
				height: 211px;
				border: 1px solid black;
				background-position: center;
				background-size: cover;
			} */
			.drop-zone {
  max-width: 350px;
  height: 350px;
  padding: 25px;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  font-family: "Quicksand", sans-serif;
  font-weight: 500;
  font-size: 20px;
  cursor: pointer;
  color: #cccccc;
  border: 4px dashed #009578;
  border-radius: 10px;
}

.drop-zone--over {
  border-style: solid;
}

.drop-zone__input {
  display: none;
}

.drop-zone__thumb {
  width: 100%;
  height: 100%;
  border-radius: 10px;
  overflow: hidden;
  background-color: #cccccc;
  background-size: cover;
  position: relative;
}

/* .drop-zone__thumb::after {
  content: attr(data-label);
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  padding: 5px 0;
  color: #ffffff;
  background: rgba(0, 0, 0, 0.75);
  font-size: 14px;
  text-align: center;
} */

		</style>
		
	</head>
	<body class="is-preload">

		<!-- Nav -->
			<nav id="nav">
				<ul class="container">
					<li><h2><a href="#top">Covid-19 Analysis</a></h2></li>
					<!-- <li><a href="#work">Work</a></li>
					<li><a href="#portfolio">Portfolio</a></li>
					<li><a href="#contact">Contact</a></li> -->
				</ul>
			</nav>
			<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.5.2/dist/tf.min.js"></script>
			<script src="https://unpkg.com/ml5@0.4.3/dist/ml5.min.js"></script>
			<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

			<!-- <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.5.2"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/1.0.2/package/lib/browser/fs.js"></script> -->
			<script>
				
				var loadFile = function (event) {
					
				var image = document.getElementById("image");
				image.src = URL.createObjectURL(event.target.files[0]);
				document.getElementById("image").style.display="block";
				};
				
				// const classifier = ml5.imageClassifier
				//  ("MobileNet", modelLoaded);
			
				//  // When the model is loaded
				//  function modelLoaded() {
				//  console.log("Model Loaded!");
				//  }

				tf.loadLayersModel("model2/model.json").then(function(model) {
				window.model = model;
				console.log("my model loaded");
				});
				
				// var canvas = document.createElement('canvas');
				// var context = canvas.getContext('2d');
				// var img = document.getElementById('image');
				// canvas.width = img.width;
				// canvas.height = img.height;
				// context.drawImage(img, 0, 0 );
				// var myData = context.getImageData(0, 0, img.width, img.height);
				// console.log(myData);
				// function processImage(path) {

				// 	const imageSize = 224;
				// 	// const imageBuffer =  fs.readFileSync(path); // can also use the async readFile instead
				// 	// get tensor out of the buffer
				// 	image = tfnode.node.decodeImage(imageBuffer, 3);
				// 	// dtype to float
				// 	image = image.cast('float32').div(255);
				// 	// resize the image
				// 	image = tf.image.resizeBilinear(image, size = [imageSize, imageSize]); // can also use tf.image.resizeNearestNeighbor
				// 	image = image.expandDims(); // to add the most left axis of size 1
				// 	// return image.shape
				// 	console.log(image);
				// }
				 function predict() {
					
					var canvas = document.createElement('canvas');
					var context = canvas.getContext('2d');
					var img = document.getElementById('image');
					// processImage(img.src);
					canvas.width = 224;
					canvas.height = 224;
					context.drawImage(img, 0, 0 );
					var myData = context.getImageData(0, 0, 224, 224).data;
					console.log(myData);
					console.log(myData.length);
					var normalArray = Array.from(myData);
					console.log(normalArray.length);
					var input = [];
					for(var i = 0; i < myData.length; i += 4) {
					input.push(myData[i]);
					}
					console.log(input.length);
					window.model.predict([tf.tensor(input).reshape([1, 224, 224, 1])]).array().then(function(scores){
					scores = scores[0];
					predicted = scores.indexOf(Math.max(...scores));
					// $('#number').html(predicted);
					console.log(predicted);
					console.log(scores);
						
					var chart = new CanvasJS.Chart("chartContainer3", {
					theme: "light2", // "light1", "light2", "dark1", "dark2"
					exportEnabled: true,
					animationEnabled: true,
					//title: {
					//  text: "Likelihood of digits"
					//},
					data: [{
						type: "pie",
						startAngle: 25,
						toolTipContent: "<b>{label}</b>: {y}%",
						showInLegend: "true",
						legendText: "{label}",
						indexLabelFontSize: 16,
						indexLabel: "{label} - {y}%",
						dataPoints: [
						{ y: scores[0], label: "0" },
						{ y: scores[1], label: "1" },
						]
					}]
					});
					chart.render();

					var chart2 = new CanvasJS.Chart("chartContainer2", {
					animationEnabled: true,
					theme: "light2", // "light1", "light2", "dark1", "dark2"
					// title:{
					// text: "Likelihood"
					// },
					axisY: {
					title: "Likelihood"
					},
					data: [{        
					type: "column",  
					showInLegend: true, 
					legendMarkerColor: "grey",
					legendText: "Digit",
					dataPoints: [      
					{ y: scores[0], label: "Non Covid" },
					{ y: scores[1], label: "Covid" },
					]
					}]
				});
					chart2.render();
					});
				//  classifier.predict(document.getElementById("image"), 
				// 		  function (err, results) {
				// 			//   alert(results[0].label);
				// 			alert(results[0].label);
				// 		  });
				}
		  	</script>
			  <!-- <script src="temo.js" type="module"></script> -->
		<!-- Home -->
			<article id="top" class="wrapper style1">
				<div class="container">
					<div class="row" style="margin-right: 10px;">
						<div class="col-4 col-5-large col-12-medium">
							<!-- <span class="image fit"><img src="images/pic00.jpg" alt="" /></span>
							 -->
							 <div class="drop-zone">
								<!-- <span class="drop-zone__prompt">Drop x-ray here or click to upload</span> -->
								<!-- <input type="file" name="myFile" class="drop-zone__input" id="imageHere"> -->
								<img style="display:none;" src="" alt="" id="image" 
								width="315px" height="200px" />
								</br></br>
								
							  </div>
							  <input type="file" accept="image/*" 
									onchange="loadFile(event)" 
									name="image" id="file" />
							 <script src="script.js"></script>
							 
						</div>
						
						<div class="col-8 col-7-large col-12-medium">
							<header>
								<h1>Hi. We're here predicting if<br><br> you are prone to <strong><br><br>Covid-19</strong>.</h1>
							</header>
							<p>Do upload the x-ray of your <strong>lungs</strong>.</p>
							<a href="#work" onclick="predict()" class="button large scrolly">Check</a>
						</div>
					</div>
				</div>
			</article>


		<!-- Work -->
			<article id="work" class="wrapper style2">
				<div class="container" >
					<header>
						<h2>Have a look at the results.</h2>

					</header>
					
					<div class="row aln-center">
						<div class="col-4 col-6-medium col-12-small">
						
							<!-- <section class="box style1">
								<span class="icon featured fa-comments"></span>
								<h3>CNN</h3>
								<p>Bar Chart</p>
								
							</section> -->
							
						<div id="chartContainer2" class="col-4 col-6-medium col-12-small">
							<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
						</div>
						</div>
						
						<!-- <div id="chartContainer3" class="col-4 col-6-medium col-12-small">
							<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
						</div> -->
						<div class="col-4 col-6-medium col-12-small">
							
							<!-- <section class="box style1">
								<span class="icon solid featured fa-camera-retro"></span>
								<h3>Decision tree Classfier</h3>
								<p>--bar chart--</p>
								
							</section> -->
							<div id="chartContainer3" class="col-4 col-6-medium col-12-small">
								<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
							</div>
						</div>
						
						<div class="col-4 col-6-medium col-12-small">
							<section class="box style1">
								<span class="icon featured fa-thumbs-up"></span>
								<h3>Using VGG-19</h3>
								<p>lIKELIHOODS</p>
							</section>
							
						</div>

					</div>
					<!-- <footer>
						<p>The result:</p>
						<a href="#portfolio" class="button large scrolly">See some of my recent work</a>
					</footer> -->
				</div>
				<!-- <div id="chartContainer2" class="col-4 col-6-medium col-12-small" >
					<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
				</div> -->
			</article>

		<!-- Portfolio -->
			<article id="portfolio" class="wrapper style3">
				<div class="container">
					<header>
						<h2>Hereâ€™s some stuff I made recently.</h2>
						<p>Proin odio consequat  sapien vestibulum consequat lorem dolore feugiat.</p>
					</header>
					<div class="row">
						<div class="col-4 col-6-medium col-12-small">
							<article class="box style2">
								<a href="#" class="image featured"><img src="images/pic01.jpg" alt="" /></a>
								<h3><a href="#">Magna feugiat</a></h3>
								<p>Ornare nulla proin odio consequat.</p>
							</article>
						</div>
						<div class="col-4 col-6-medium col-12-small">
							<article class="box style2">
								<a href="#" class="image featured"><img src="images/pic02.jpg" alt="" /></a>
								<h3><a href="#">Veroeros primis</a></h3>
								<p>Ornare nulla proin odio consequat.</p>
							</article>
						</div>
						<div class="col-4 col-6-medium col-12-small">
							<article class="box style2">
								<a href="#" class="image featured"><img src="images/pic03.jpg" alt="" /></a>
								<h3><a href="#">Lorem ipsum</a></h3>
								<p>Ornare nulla proin odio consequat.</p>
							</article>
						</div>
						<div class="col-4 col-6-medium col-12-small">
							<article class="box style2">
								<a href="#" class="image featured"><img src="images/pic04.jpg" alt="" /></a>
								<h3><a href="#">Tempus dolore</a></h3>
								<p>Ornare nulla proin odio consequat.</p>
							</article>
						</div>
						<div class="col-4 col-6-medium col-12-small">
							<article class="box style2">
								<a href="#" class="image featured"><img src="images/pic05.jpg" alt="" /></a>
								<h3><a href="#">Feugiat aliquam</a></h3>
								<p>Ornare nulla proin odio consequat.</p>
							</article>
						</div>
						<div class="col-4 col-6-medium col-12-small">
							<article class="box style2">
								<a href="#" class="image featured"><img src="images/pic06.jpg" alt="" /></a>
								<h3><a href="#">Sed amet ornare</a></h3>
								<p>Ornare nulla proin odio consequat.</p>
							</article>
						</div>
					</div>
					<footer>
						<p>Lorem ipsum dolor sit sapien vestibulum ipsum primis?</p>
						<a href="#contact" class="button large scrolly">Get in touch with me</a>
					</footer>
				</div>
			</article>

		<!-- Contact -->
			<article id="contact" class="wrapper style4">
				<div class="container medium">
					<header>
						<h2>Have me make stuff for you.</h2>
						<p>Ornare nulla proin odio consequat sapien vestibulum ipsum.</p>
					</header>
					<div class="row">
						<div class="col-12">
							<form method="post" action="#">
								<div class="row">
									<div class="col-6 col-12-small">
										<input type="text" name="name" id="name" placeholder="Name" />
									</div>
									<div class="col-6 col-12-small">
										<input type="text" name="email" id="email" placeholder="Email" />
									</div>
									<div class="col-12">
										<input type="text" name="subject" id="subject" placeholder="Subject" />
									</div>
									<div class="col-12">
										<textarea name="message" id="message" placeholder="Message"></textarea>
									</div>
									<div class="col-12">
										<ul class="actions">
											<li><input type="submit" value="Send Message" /></li>
											<li><input type="reset" value="Clear Form" class="alt" /></li>
										</ul>
									</div>
								</div>
							</form>
						</div>
						<div class="col-12">
							<hr />
							<h3>Find me on ...</h3>
							<ul class="social">
								<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
								<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
								<li><a href="#" class="icon brands fa-dribbble"><span class="label">Dribbble</span></a></li>
								<li><a href="#" class="icon brands fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
								<li><a href="#" class="icon brands fa-tumblr"><span class="label">Tumblr</span></a></li>
								<li><a href="#" class="icon brands fa-google-plus"><span class="label">Google+</span></a></li>
								<li><a href="#" class="icon brands fa-github"><span class="label">Github</span></a></li>
								<!--
								<li><a href="#" class="icon solid fa-rss"><span>RSS</span></a></li>
								<li><a href="#" class="icon brands fa-instagram"><span>Instagram</span></a></li>
								<li><a href="#" class="icon brands fa-foursquare"><span>Foursquare</span></a></li>
								<li><a href="#" class="icon brands fa-skype"><span>Skype</span></a></li>
								<li><a href="#" class="icon brands fa-soundcloud"><span>Soundcloud</span></a></li>
								<li><a href="#" class="icon brands fa-youtube"><span>YouTube</span></a></li>
								<li><a href="#" class="icon brands fa-blogger"><span>Blogger</span></a></li>
								<li><a href="#" class="icon brands fa-flickr"><span>Flickr</span></a></li>
								<li><a href="#" class="icon brands fa-vimeo"><span>Vimeo</span></a></li>
								-->
							</ul>
							<hr />
						</div>
					</div>
					<footer>
						<ul id="copyright">
							<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
						</ul>
					</footer>
				</div>
			</article>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>